#!/usr/bin/env bash
set -euo pipefail

SCRIPT_DIR=$( cd -- "$( dirname -- $(readlink -f "$0") )" &> /dev/null && pwd )
WORK_DIR=$(pwd)

usage() {
  cat <<EOF
Usage: start [codex CLI args...]

Starts the Codex CLI Docker container and passes any additional arguments to the codex command inside the container.
EOF
}

if [[ "${1:-}" =~ ^(-h|--help)$ ]]; then
  usage
  exit 0
fi

echo "ðŸš€ Starting Codex CLI..."
if command -v docker-compose > /dev/null 2>&1; then
  DC="docker-compose"
else
  DC="docker compose"
fi
WORK_DIR=${WORK_DIR} ${DC} -f "${SCRIPT_DIR}/docker-compose.yml" run --rm codex "$@"
